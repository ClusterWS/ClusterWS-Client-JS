!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n=e();for(var o in n)("object"==typeof exports?exports:t)[o]=n[o]}}(this,function(){return function(t){function e(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:o})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=2)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){return function e(){for(var n=[],o=0;arguments.length>o;o++)n[o]=arguments[o];return t.length>n.length?function(){for(var t=[],o=0;arguments.length>o;o++)t[o]=arguments[o];return e.call.apply(e,[null].concat(n,t))}:t.length?t.call.apply(t,[null].concat(n)):t}},r=function(t){return t?"function"==typeof t?t():t:""},i=o(function(t,e){return r(e in t?t[e]:t.default)}),c=function(t,e){for(var n=-1,o=null==e?0:e.length,r=Array(o);++n<o;)r[n]=t(e[n],n,e);return r},s=function(t,e){var n={};return e=Object(e),Object.keys(e).forEach(function(o){return n[o]=t(e[o],o,e)}),n};e._={map:o(function(t,e){return e instanceof Array?c(t,e):s(t,e)}),curry:o,switchcase:i}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.logError=function(t){return console.log("Error: ",t)}},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),i=n(7);e.ClusterWS=function(t){function e(e){return t.call(this,new i.Options(e||{}))||this}return o(e,t),e}(r.Socket)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),r=n(4),i=n(5),c=n(6);e.Socket=function(){function t(t){this.options=t,this.events=new i.EventEmitter,this.channels={},this.autoReconnect=!1,this.inReconnectionState=!1,this.reconnectionAttempted=0,this.autoReconnect=this.options.autoReconnect,this.connect()}return t.prototype.connect=function(t){var e=this;this.webSocket=null,this.webSocket=new WebSocket("ws://"+this.options.url+":"+this.options.port),this.webSocket.onerror=function(t){return e.events.emit("error",t)},this.webSocket.onopen=function(){clearInterval(t),e.inReconnectionState=!1,e.reconnectionAttempted=0,o._.map(function(t){return t.subscribe()},e.channels),e.events.emit("connect")},this.webSocket.onmessage=function(t){if("#0"===t.data)return e.send("#1",null,"ping");t=JSON.parse(t.data),o._.switchcase({p:function(){return e.channels[t.m[1]]?e.channels[t.m[1]].message(t.m[2]):""},e:function(){return e.events.emit(t.m[1],t.m[2])},s:function(){return o._.switchcase({c:function(){}})(t.m[1])}})(t.m[0])},this.webSocket.onclose=function(t){if(e.events.emit("disconnect",t.code,t.reason),e.autoReconnect&&1e3!==t.code)return e.inReconnectionState?"":e.reconnection();e.events.removeAllEvents();for(var n in e)e.hasOwnProperty(n)&&(e[n]=null,delete e[n])}},t.prototype.subscribe=function(t){return this.channels[t]?this.channels[t]:this.channels[t]=new r.Channel(t,this)},t.prototype.disconnect=function(t,e){this.webSocket.close(t||1e3,e)},t.prototype.on=function(t,e){this.events.on(t,e)},t.prototype.send=function(t,e,n){this.webSocket.send(c.socketMessages(t,e,n||"emit"))},t.prototype.reconnection=function(){var t=this;this.inReconnectionState=!0;var e=setInterval(function(){t.webSocket.readyState===t.webSocket.CLOSED&&(t.reconnectionAttempted++,t.connect(e),0===t.options.reconnectionAttempts||t.options.reconnectionAttempts>t.reconnectionAttempted||(clearInterval(e),t.autoReconnect=!1,t.inReconnectionState=!1))},this.options.reconnectionInterval)},t}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Channel=function(){function t(t,e){this.channel=t,this.socket=e,this.subscribe()}return t.prototype.watch=function(t){return this.event=t,this},t.prototype.publish=function(t){return this.socket.send(this.channel,t,"publish"),this},t.prototype.message=function(t){this.event&&this.event(t)},t.prototype.unsubscribe=function(){this.socket.send("unsubscribe",this.channel,"system")},t.prototype.subscribe=function(){this.socket.send("subscribe",this.channel,"system")},t}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),r=n(1);e.EventEmitter=function(){function t(){this._events={}}return t.prototype.on=function(t,e){e&&"function"==typeof e||r.logError("Listener must be a function"),this._events[t]?this._events[t].push(e):this._events[t]=[e]},t.prototype.emit=function(t){for(var e=[],n=1;arguments.length>n;n++)e[n-1]=arguments[n];o._.map(function(t){return t.call.apply(t,[null].concat(e))},this._events[t])},t.prototype.removeListener=function(t,e){var n=this;o._.map(function(o,r){return o===e?n._events[t].splice(r,1):""},this._events[t])},t.prototype.removeEvent=function(t){this._events[t]=null},t.prototype.removeAllEvents=function(){this._events={}},t.prototype.exist=function(t){return this._events[t]},t}()},function(t,e,n){"use strict";function o(t,e,n){return r._.switchcase({publish:JSON.stringify({m:["p",t,e]}),emit:JSON.stringify({m:["e",t,e]}),system:r._.switchcase({subscribe:JSON.stringify({m:["s","s",e]}),unsubscribe:JSON.stringify({m:["s","u",e]})})(t),ping:t})(n)}Object.defineProperty(e,"__esModule",{value:!0});var r=n(0);e.socketMessages=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(1);e.Options=function(){function t(t){if(!t.url)throw o.logError("Url must be provided");if(!t.port)throw o.logError("Port must be provided");this.url=t.url,this.port=t.port,this.autoReconnect=t.autoReconnect||!1,this.reconnectionInterval=t.reconnectionInterval||1e4,this.reconnectionAttempts=t.reconnectionAttempts||0}return t}()}])});