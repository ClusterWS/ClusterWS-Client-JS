!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var o in n)("object"==typeof exports?exports:e)[o]=n[o]}}(this,function(){return function(e){function t(o){if(n[o])return n[o].exports;var s=n[o]={i:o,l:!1,exports:{}};return e[o].call(s.exports,s,s.exports,t),s.l=!0,s.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=1)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){this.event=e,this.data=t,this.action="emit"}return e}(),s=function(){function e(e,t){this.channel=e,this.data=t,this.action="publish"}return e}(),i=function(){function e(e,t){this.event=e,this.data=t,this.action="sys"}return e}();t.MessageFactory=function(){function e(){}return e.emitMessage=function(e,t){return JSON.stringify(new o(e,t))},e.publishMessage=function(e,t){return JSON.stringify(new s(e,t))},e.systemMessage=function(e,t){return JSON.stringify(new i(e,t))},e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),s=n(0),i=function(){function e(e,t){if(!e)throw Error("Url must be provided");if(!t)throw Error("Port must be provided");this.url=e,this.port=t}return e}();t.ClusterWS=function(){function e(e){var t=this;this.configurations=e,this.events={},this.channels={},e=e||{},this.options=new i(e.url,e.port),this.webSocket=new WebSocket("ws://"+this.options.url+":"+this.options.port),this.webSocket.onopen=function(e){t._execEventFn("connect",e)},this.webSocket.onclose=function(e){t._execEventFn("disconnect",e);for(var n in t.channels)t.channels.hasOwnProperty(n)&&(t.channels[n]=null,delete t.channels[n]);for(var n in t.events)t.events.hasOwnProperty(n)&&(t.events[n]=null,delete t.events[n]);for(var n in t)t.hasOwnProperty(n)&&(t[n]=null,delete t[n])},this.webSocket.onerror=function(e){t._execEventFn("error",e)},this.webSocket.onmessage=function(e){if(console.log(e),"_0"===e)return t.webSocket.send("_1");e=JSON.parse(e.data),"emit"===e.action&&t._execEventFn(e.event,e.data),"publish"===e.action&&t._execChannelFn(e.channel,e.data)}}return e.prototype._execEventFn=function(e,t){var n=this.events[e];n&&n(t)},e.prototype._execChannelFn=function(e,t){var n=this.channels[e];n&&n(t)},e.prototype.on=function(e,t){this.events[e]&&(this.events[e]=null),this.events[e]=t},e.prototype.send=function(e,t){this.webSocket.send(s.MessageFactory.emitMessage(e,t))},e.prototype.subscribe=function(e){return new o.Channel(e,this)},e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(0);t.Channel=function(){function e(e,t){this.channel=e,this.client=t,this.client.webSocket.send(o.MessageFactory.systemMessage("subscribe",this.channel))}return e.prototype.watch=function(e){return this.client.channels[this.channel]=e,this},e.prototype.publish=function(e){return this.client.webSocket.send(o.MessageFactory.publishMessage(this.channel,e)),this},e}()}])});