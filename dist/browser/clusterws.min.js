var ClusterWS=function(){"use strict";var t;!function(t){t[t.ALL=0]="ALL",t[t.DEBUG=1]="DEBUG",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR"}(t||(t={}));var e=function(){function e(t){this.level=t}return e.prototype.debug=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];this.level>t.DEBUG||console.log.apply(console,["[36mdebug:[0m"].concat(e.map(function(t){return"object"==typeof t?JSON.stringify(t):t})))},e.prototype.info=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];this.level>t.INFO||console.log.apply(console,["[32minfo:[0m"].concat(e))},e.prototype.error=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];this.level>t.ERROR||console.log.apply(console,["[31merror:[0m"].concat(e))},e.prototype.warning=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];this.level>t.WARN||console.log.apply(console,["[33mwarning:[0m"].concat(e))},e}();var o=function(){function t(t){this.logger=t,this.events={}}return t.prototype.on=function(t,e){if("function"!=typeof e)return this.logger.error("Listener must be a function");this.events[t]=e},t.prototype.emit=function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];var n=this.events[t];n&&n.apply(void 0,e)},t.prototype.exist=function(t){return!!this.events[t]},t.prototype.off=function(t){delete this.events[t]},t.prototype.removeEvents=function(){this.events={}},t}(),n=window.MozWebSocket||window.WebSocket;return function(){function r(n){if(this.options={url:n.url,autoConnect:!1!==n.autoConnect,autoReconnect:n.autoReconnect||!1,autoResubscribe:!1!==n.autoResubscribe,autoReconnectOptions:{},logger:n.loggerOptions&&n.loggerOptions.logger?n.loggerOptions.logger:new e(n.loggerOptions&&n.loggerOptions.level?n.loggerOptions.level:t.ALL)},!this.options.url)return this.options.logger.error("url must be provided");this.emitter=new o(this.options.logger),this.options.autoConnect&&this.connect()}return Object.defineProperty(r.prototype,"readyState",{get:function(){return this.socket?this.socket.readyState:0},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"binaryType",{get:function(){return this.socket.binaryType},set:function(t){this.socket.binaryType=t},enumerable:!0,configurable:!0}),r.prototype.connect=function(){var t=this;if(this.isCreated)return this.options.logger.error("Connect event has been called multiple times");this.isCreated=!0,this.socket=new n(this.options.url),this.socket.onopen=function(){},this.socket.onclose=function(){},this.socket.onmessage=function(e){var o=e;if(e.data&&(o=e.data),t.emitter.exist("message"))return t.emitter.emit("message",o);t.processMessage(o)},this.socket.onerror=function(e){if(t.emitter.exist("error"))return t.emitter.emit("error",e);t.options.logger.error(e),t.close()}},r.prototype.on=function(t,e){this.emitter.on(t,e)},r.prototype.close=function(t,e){this.socket.close(t||1e3,e)},r.prototype.processMessage=function(t){},r}()}();
